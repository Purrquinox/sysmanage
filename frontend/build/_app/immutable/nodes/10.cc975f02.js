import{S as ze,i as Ye,s as Fe,C as Ke,k as X,q as z,a as v,y as w,l as Z,m as x,r as Y,h as a,c as g,z as k,n as le,b as f,G as Ae,A as S,I as Qe,g as b,d,B as y,J as U,w as M,ac as G,ad as O}from"../chunks/index.607a4587.js";import{h as We}from"../chunks/singletons.6452c667.js";import{e as Xe,s as Ze,B as xe}from"../chunks/strings.82d8c965.js";import{G as oe}from"../chunks/GreyText.545daa15.js";import{I as q}from"../chunks/InputSm.96943004.js";import{S as Oe}from"../chunks/Select.43d10eda.js";const et=We("goto");function tt(t){let s;return{c(){s=z("If you want to add a build integration or a git deploy hook, you can do so later after creating the service!")},l(n){s=Y(n,"If you want to add a build integration or a git deploy hook, you can do so later after creating the service!")},m(n,l){f(n,s,l)},d(n){n&&a(s)}}}function nt(t){return{c:U,l:U,m:U,p:U,i:U,o:U,d:U}}function st(t){var de,he;let s,n,l,m,_,$,h,p,u,o,c,E,F,P,N,K,H,C,Q,L,I,W,R,V,r,A,B,ee,D,ue,te,T,ae,ne,j,se,J,ie;function Be(e){t[12](e)}let fe={id:"name",label:"Service Name",placeholder:"arcadia, ibl-backup etc.",minlength:1};t[0]!==void 0&&(fe.value=t[0]),l=new q({props:fe}),M.push(()=>G(l,"value",Be));function Je(e){t[13](e)}let pe={id:"command",label:"Command (must start with /usr/bin/)",placeholder:"E.g. /usr/bin/arcadia",minlength:3};t[1]!==void 0&&(pe.value=t[1]),$=new q({props:pe}),M.push(()=>G($,"value",Je));function Pe(e){t[14](e)}let me={id:"directory",label:"Directory",placeholder:"E.g. /root/arcadia",minlength:3};t[2]!==void 0&&(me.value=t[2]),u=new q({props:me}),M.push(()=>G(u,"value",Pe));function Ue(e){t[15](e)}let $e={name:"target",placeholder:"Choose Target",options:new Map((he=(de=t[9])==null?void 0:de.Targets)==null?void 0:he.map(Ve))};t[3]!==void 0&&($e.value=t[3]),E=new Oe({props:$e}),M.push(()=>G(E,"value",Ue));function qe(e){t[16](e)}let _e={id:"description",label:"Description",placeholder:"E.g. Arcadia",minlength:5};t[4]!==void 0&&(_e.value=t[4]),N=new q({props:_e}),M.push(()=>G(N,"value",qe));function He(e){t[17](e)}let ce={id:"after",label:"After",placeholder:"E.g. ibl-maint",minlength:1};t[7]!==void 0&&(ce.value=t[7]),C=new q({props:ce}),M.push(()=>G(C,"value",He));function Le(e){t[18](e)}let ve={name:"broken",placeholder:"Is the service broken/disabled?",options:new Map([["Yes, it is","0"],["No, its not","1"]])};t[8]!==void 0&&(ve.value=t[8]),I=new Oe({props:ve}),M.push(()=>G(I,"value",Le)),B=new oe({props:{$$slots:{default:[it]},$$scope:{ctx:t}}});function Re(e){t[19](e)}let ge={id:"user",label:"User",placeholder:"E.g. root",minlength:1};t[5]!==void 0&&(ge.value=t[5]),D=new q({props:ge}),M.push(()=>G(D,"value",Re));function je(e){t[20](e)}let be={id:"group",label:"Group",placeholder:"E.g. root",minlength:1};return t[6]!==void 0&&(be.value=t[6]),T=new q({props:be}),M.push(()=>G(T,"value",je)),J=new xe({props:{onclick:t[21],$$slots:{default:[lt]},$$scope:{ctx:t}}}),{c(){s=X("div"),n=v(),w(l.$$.fragment),_=v(),w($.$$.fragment),p=v(),w(u.$$.fragment),c=v(),w(E.$$.fragment),P=v(),w(N.$$.fragment),H=v(),w(C.$$.fragment),L=v(),w(I.$$.fragment),R=v(),V=X("h2"),r=z("Service User"),A=v(),w(B.$$.fragment),ee=v(),w(D.$$.fragment),te=v(),w(T.$$.fragment),ne=v(),j=X("div"),se=v(),w(J.$$.fragment),this.h()},l(e){s=Z(e,"DIV",{id:!0}),x(s).forEach(a),n=g(e),k(l.$$.fragment,e),_=g(e),k($.$$.fragment,e),p=g(e),k(u.$$.fragment,e),c=g(e),k(E.$$.fragment,e),P=g(e),k(N.$$.fragment,e),H=g(e),k(C.$$.fragment,e),L=g(e),k(I.$$.fragment,e),R=g(e),V=Z(e,"H2",{class:!0});var i=x(V);r=Y(i,"Service User"),i.forEach(a),A=g(e),k(B.$$.fragment,e),ee=g(e),k(D.$$.fragment,e),te=g(e),k(T.$$.fragment,e),ne=g(e),j=Z(e,"DIV",{class:!0}),x(j).forEach(a),se=g(e),k(J.$$.fragment,e),this.h()},h(){le(s,"id",JSON.stringify(t[22])),le(V,"class","text-xl font-semibold mt-4"),le(j,"class","mb-2")},m(e,i){f(e,s,i),f(e,n,i),S(l,e,i),f(e,_,i),S($,e,i),f(e,p,i),S(u,e,i),f(e,c,i),S(E,e,i),f(e,P,i),S(N,e,i),f(e,H,i),S(C,e,i),f(e,L,i),S(I,e,i),f(e,R,i),f(e,V,i),Ae(V,r),f(e,A,i),S(B,e,i),f(e,ee,i),S(D,e,i),f(e,te,i),S(T,e,i),f(e,ne,i),f(e,j,i),f(e,se,i),S(J,e,i),ie=!0},p(e,i){var Me,Ge;const we={};!m&&i&1&&(m=!0,we.value=e[0],O(()=>m=!1)),l.$set(we);const ke={};!h&&i&2&&(h=!0,ke.value=e[1],O(()=>h=!1)),$.$set(ke);const Se={};!o&&i&4&&(o=!0,Se.value=e[2],O(()=>o=!1)),u.$set(Se);const re={};i&512&&(re.options=new Map((Ge=(Me=e[9])==null?void 0:Me.Targets)==null?void 0:Ge.map(Ve))),!F&&i&8&&(F=!0,re.value=e[3],O(()=>F=!1)),E.$set(re);const ye={};!K&&i&16&&(K=!0,ye.value=e[4],O(()=>K=!1)),N.$set(ye);const Ee={};!Q&&i&128&&(Q=!0,Ee.value=e[7],O(()=>Q=!1)),C.$set(Ee);const Ne={};!W&&i&256&&(W=!0,Ne.value=e[8],O(()=>W=!1)),I.$set(Ne);const Ce={};i&8388608&&(Ce.$$scope={dirty:i,ctx:e}),B.$set(Ce);const Ie={};!ue&&i&32&&(ue=!0,Ie.value=e[5],O(()=>ue=!1)),D.$set(Ie);const De={};!ae&&i&64&&(ae=!0,De.value=e[6],O(()=>ae=!1)),T.$set(De);const Te={};i&8388608&&(Te.$$scope={dirty:i,ctx:e}),J.$set(Te)},i(e){ie||(b(l.$$.fragment,e),b($.$$.fragment,e),b(u.$$.fragment,e),b(E.$$.fragment,e),b(N.$$.fragment,e),b(C.$$.fragment,e),b(I.$$.fragment,e),b(B.$$.fragment,e),b(D.$$.fragment,e),b(T.$$.fragment,e),b(J.$$.fragment,e),ie=!0)},o(e){d(l.$$.fragment,e),d($.$$.fragment,e),d(u.$$.fragment,e),d(E.$$.fragment,e),d(N.$$.fragment,e),d(C.$$.fragment,e),d(I.$$.fragment,e),d(B.$$.fragment,e),d(D.$$.fragment,e),d(T.$$.fragment,e),d(J.$$.fragment,e),ie=!1},d(e){e&&a(s),e&&a(n),y(l,e),e&&a(_),y($,e),e&&a(p),y(u,e),e&&a(c),y(E,e),e&&a(P),y(N,e),e&&a(H),y(C,e),e&&a(L),y(I,e),e&&a(R),e&&a(V),e&&a(A),y(B,e),e&&a(ee),y(D,e),e&&a(te),y(T,e),e&&a(ne),e&&a(j),e&&a(se),y(J,e)}}}function it(t){let s;return{c(){s=z("Defaults to root if unset. Note that this could be a possible security risk to use the wrong user/group!")},l(n){s=Y(n,"Defaults to root if unset. Note that this could be a possible security risk to use the wrong user/group!")},m(n,l){f(n,s,l)},d(n){n&&a(s)}}}function lt(t){let s;return{c(){s=z("Create Service")},l(n){s=Y(n,"Create Service")},m(n,l){f(n,s,l)},d(n){n&&a(s)}}}function ut(t){let s,n;return s=new oe({props:{$$slots:{default:[at]},$$scope:{ctx:t}}}),{c(){w(s.$$.fragment)},l(l){k(s.$$.fragment,l)},m(l,m){S(s,l,m),n=!0},p(l,m){const _={};m&8388608&&(_.$$scope={dirty:m,ctx:l}),s.$set(_)},i(l){n||(b(s.$$.fragment,l),n=!0)},o(l){d(s.$$.fragment,l),n=!1},d(l){y(s,l)}}}function at(t){let s;return{c(){s=z("Loading metadata...")},l(n){s=Y(n,"Loading metadata...")},m(n,l){f(n,s,l)},d(n){n&&a(s)}}}function rt(t){let s,n,l,m,_,$,h;m=new oe({props:{$$slots:{default:[tt]},$$scope:{ctx:t}}});let p={ctx:t,current:null,token:null,hasCatch:!1,pending:ut,then:st,catch:nt,value:22,blocks:[,,,]};return Ke(t[10](),p),{c(){s=X("h1"),n=z("Create New Service"),l=v(),w(m.$$.fragment),_=v(),$=X("div"),p.block.c(),this.h()},l(u){s=Z(u,"H1",{class:!0});var o=x(s);n=Y(o,"Create New Service"),o.forEach(a),l=g(u),k(m.$$.fragment,u),_=g(u),$=Z(u,"DIV",{});var c=x($);p.block.l(c),c.forEach(a),this.h()},h(){le(s,"class","text-2xl font-semibold")},m(u,o){f(u,s,o),Ae(s,n),f(u,l,o),S(m,u,o),f(u,_,o),f(u,$,o),p.block.m($,p.anchor=null),p.mount=()=>$,p.anchor=null,h=!0},p(u,[o]){t=u;const c={};o&8388608&&(c.$$scope={dirty:o,ctx:t}),m.$set(c),Qe(p,t,o)},i(u){h||(b(m.$$.fragment,u),b(p.block),h=!0)},o(u){d(m.$$.fragment,u);for(let o=0;o<3;o+=1){const c=p.blocks[o];d(c)}h=!1},d(u){u&&a(s),u&&a(l),y(m,u),u&&a(_),u&&a($),p.block.d(),p.token=null,p=null}}}const Ve=t=>[(t==null?void 0:t.Name)+" - "+(t==null?void 0:t.Description),t==null?void 0:t.Name];function ot(t,s,n){let l,m="/usr/bin/",_="/root/",$,h,p,u,o="ibl-maint",c="0",E={};const F=async()=>{let r=await fetch("/api/systemd/getMeta",{method:"POST"});if(!r.ok){let A=await r.text();throw new Error(A)}return n(9,E=await r.json()),null},P=async()=>{let r=await fetch("/api/systemd/createService",{method:"POST",body:JSON.stringify({name:l,service:{cmd:m,dir:_,target:$,description:h,after:o,broken:c==="0",user:p,group:u}})});if(!r.ok){let A=await r.text();Xe(A);return}Ze("Service created successfully!"),setTimeout(()=>{et(`/plugins/systemd/service?id=${l}`)},1e3)};function N(r){l=r,n(0,l)}function K(r){m=r,n(1,m)}function H(r){_=r,n(2,_)}function C(r){$=r,n(3,$)}function Q(r){h=r,n(4,h)}function L(r){o=r,n(7,o)}function I(r){c=r,n(8,c)}function W(r){p=r,n(5,p)}function R(r){u=r,n(6,u)}return[l,m,_,$,h,p,u,o,c,E,F,P,N,K,H,C,Q,L,I,W,R,()=>P()]}class vt extends ze{constructor(s){super(),Ye(this,s,ot,rt,Fe,{})}}export{vt as component};
