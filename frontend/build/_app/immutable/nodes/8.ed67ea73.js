import{S as Te,i as Ie,s as Le,w as $e,ac as _e,C as Be,a as A,k as K,q as B,y as O,ab as Ce,h as _,c as D,l as R,m as F,r as C,z as y,n as z,b as S,G as v,A as M,d,f as re,g as $,ad as pe,I as He,B as P,v as se,J as G,K as Oe,e as he}from"../chunks/index.607a4587.js";import{S as ye}from"../chunks/Service.e3ed56e7.js";import{I as de}from"../chunks/InputSm.96943004.js";import{B as Me,e as ae,s as ge}from"../chunks/strings.82d8c965.js";import{T as Pe,n as Ne}from"../chunks/tasks.746ddd9e.js";import{D as le}from"../chunks/DangerButton.30216a4e.js";import{B as be}from"../chunks/Button.e2b5263d.js";function ke(s,t,e){const n=s.slice();return n[19]=t[e],n}function Ye(s){let t;return{c(){t=B("Build Services")},l(e){t=C(e,"Build Services")},m(e,n){S(e,t,n)},d(e){e&&_(t)}}}function je(s){let t;return{c(){t=B("New Service")},l(e){t=C(e,"New Service")},m(e,n){S(e,t,n)},d(e){e&&_(t)}}}function qe(s){let t;return{c(){t=B("Meta Editor")},l(e){t=C(e,"Meta Editor")},m(e,n){S(e,t,n)},d(e){e&&_(t)}}}function Ke(s){let t,e;return t=new le({props:{onclick:s[12],$$slots:{default:[Fe]},$$scope:{ctx:s}}}),{c(){O(t.$$.fragment)},l(n){y(t.$$.fragment,n)},m(n,r){M(t,n,r),e=!0},p(n,r){const o={};r&16&&(o.onclick=n[12]),r&8388608&&(o.$$scope={dirty:r,ctx:n}),t.$set(o)},i(n){e||($(t.$$.fragment,n),e=!0)},o(n){d(t.$$.fragment,n),e=!1},d(n){P(t,n)}}}function Re(s){let t,e;return t=new le({props:{onclick:s[11],$$slots:{default:[Ve]},$$scope:{ctx:s}}}),{c(){O(t.$$.fragment)},l(n){y(t.$$.fragment,n)},m(n,r){M(t,n,r),e=!0},p(n,r){const o={};r&16&&(o.onclick=n[11]),r&8388608&&(o.$$scope={dirty:r,ctx:n}),t.$set(o)},i(n){e||($(t.$$.fragment,n),e=!0)},o(n){d(t.$$.fragment,n),e=!1},d(n){P(t,n)}}}function Fe(s){let t;return{c(){t=B("Show Dangerous Actions")},l(e){t=C(e,"Show Dangerous Actions")},m(e,n){S(e,t,n)},d(e){e&&_(t)}}}function Ve(s){let t;return{c(){t=B("Hide Dangerous Actions")},l(e){t=C(e,"Hide Dangerous Actions")},m(e,n){S(e,t,n)},d(e){e&&_(t)}}}function we(s){let t,e,n,r,o,l,u,i,T;return r=new le({props:{onclick:s[13],$$slots:{default:[We]},$$scope:{ctx:s}}}),l=new le({props:{onclick:s[14],$$slots:{default:[ze]},$$scope:{ctx:s}}}),i=new le({props:{onclick:s[15],$$slots:{default:[Ge]},$$scope:{ctx:s}}}),{c(){t=K("h2"),e=B("Dangerous Actions"),n=A(),O(r.$$.fragment),o=A(),O(l.$$.fragment),u=A(),O(i.$$.fragment),this.h()},l(a){t=R(a,"H2",{class:!0});var p=F(t);e=C(p,"Dangerous Actions"),p.forEach(_),n=D(a),y(r.$$.fragment,a),o=D(a),y(l.$$.fragment,a),u=D(a),y(i.$$.fragment,a),this.h()},h(){z(t,"class","mt-2 text-xl font-semibold text-red-400")},m(a,p){S(a,t,p),v(t,e),S(a,n,p),M(r,a,p),S(a,o,p),M(l,a,p),S(a,u,p),M(i,a,p),T=!0},p(a,p){const w={};p&8388608&&(w.$$scope={dirty:p,ctx:a}),r.$set(w);const E={};p&8388608&&(E.$$scope={dirty:p,ctx:a}),l.$set(E);const j={};p&8388608&&(j.$$scope={dirty:p,ctx:a}),i.$set(j)},i(a){T||($(r.$$.fragment,a),$(l.$$.fragment,a),$(i.$$.fragment,a),T=!0)},o(a){d(r.$$.fragment,a),d(l.$$.fragment,a),d(i.$$.fragment,a),T=!1},d(a){a&&_(t),a&&_(n),P(r,a),a&&_(o),P(l,a),a&&_(u),P(i,a)}}}function We(s){let t;return{c(){t=B("Restart Server")},l(e){t=C(e,"Restart Server")},m(e,n){S(e,t,n)},d(e){e&&_(t)}}}function ze(s){let t;return{c(){t=B("Kill Services For Maintenance")},l(e){t=C(e,"Kill Services For Maintenance")},m(e,n){S(e,t,n)},d(e){e&&_(t)}}}function Ge(s){let t;return{c(){t=B("Start All Services")},l(e){t=C(e,"Start All Services")},m(e,n){S(e,t,n)},d(e){e&&_(t)}}}function ve(s){let t,e;return t=new Pe({props:{output:s[3]}}),{c(){O(t.$$.fragment)},l(n){y(t.$$.fragment,n)},m(n,r){M(t,n,r),e=!0},p(n,r){const o={};r&8&&(o.output=n[3]),t.$set(o)},i(n){e||($(t.$$.fragment,n),e=!0)},o(n){d(t.$$.fragment,n),e=!1},d(n){P(t,n)}}}function Je(s){let t,e=s[22]+"",n;return{c(){t=K("h2"),n=B(e),this.h()},l(r){t=R(r,"H2",{class:!0});var o=F(t);n=C(o,e),o.forEach(_),this.h()},h(){z(t,"class","text-red-500")},m(r,o){S(r,t,o),v(t,n)},p:G,i:G,o:G,d(r){r&&_(t)}}}function Qe(s){let t,e,n=s[18],r=[];for(let l=0;l<n.length;l+=1)r[l]=Ee(ke(s,n,l));const o=l=>d(r[l],1,1,()=>{r[l]=null});return{c(){t=K("div");for(let l=0;l<r.length;l+=1)r[l].c();this.h()},l(l){t=R(l,"DIV",{class:!0});var u=F(t);for(let i=0;i<r.length;i+=1)r[i].l(u);u.forEach(_),this.h()},h(){z(t,"class","flex flex-wrap justify-center items-center justify-evenly")},m(l,u){S(l,t,u);for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(t,null);e=!0},p(l,u){if(u&99){n=l[18];let i;for(i=0;i<n.length;i+=1){const T=ke(l,n,i);r[i]?(r[i].p(T,u),$(r[i],1)):(r[i]=Ee(T),r[i].c(),$(r[i],1),r[i].m(t,null))}for(se(),i=n.length;i<r.length;i+=1)o(i);re()}},i(l){if(!e){for(let u=0;u<n.length;u+=1)$(r[u]);e=!0}},o(l){r=r.filter(Boolean);for(let u=0;u<r.length;u+=1)d(r[u]);e=!1},d(l){l&&_(t),Oe(r,l)}}}function Se(s){let t,e;return t=new ye({props:{service:s[19]}}),{c(){O(t.$$.fragment)},l(n){y(t.$$.fragment,n)},m(n,r){M(t,n,r),e=!0},p:G,i(n){e||($(t.$$.fragment,n),e=!0)},o(n){d(t.$$.fragment,n),e=!1},d(n){P(t,n)}}}function Ee(s){let t=s[6](s[19],s[0],s[1]),e,n,r=t&&Se(s);return{c(){r&&r.c(),e=he()},l(o){r&&r.l(o),e=he()},m(o,l){r&&r.m(o,l),S(o,e,l),n=!0},p(o,l){l&3&&(t=o[6](o[19],o[0],o[1])),t?r?(r.p(o,l),l&3&&$(r,1)):(r=Se(o),r.c(),$(r,1),r.m(e.parentNode,e)):r&&(se(),d(r,1,1,()=>{r=null}),re())},i(o){n||($(r),n=!0)},o(o){d(r),n=!1},d(o){r&&r.d(o),o&&_(e)}}}function Ue(s){let t,e;return{c(){t=K("h2"),e=B("Loading service list"),this.h()},l(n){t=R(n,"H2",{class:!0});var r=F(t);e=C(r,"Loading service list"),r.forEach(_),this.h()},h(){z(t,"class","text-xl")},m(n,r){S(n,t,r),v(t,e)},p:G,i:G,o:G,d(n){n&&_(t)}}}function Xe(s){let t,e,n,r,o,l,u,i,T,a,p,w,E,j,J,V,X,q,Z,x,f,g,I,N,H,Q,U,W;l=new Me({props:{onclick:s[10],$$slots:{default:[Ye]},$$scope:{ctx:s}}}),i=new be({props:{link:"/plugins/systemd/new",$$slots:{default:[je]},$$scope:{ctx:s}}}),a=new be({props:{link:"/plugins/systemd/meta",$$slots:{default:[qe]},$$scope:{ctx:s}}});const ee=[Re,Ke],Y=[];function ie(m,h){return m[4]?0:1}w=ie(s),E=Y[w]=ee[w](s);let b=s[4]&&we(s),k=s[2]!=""&&ve(s);function Ae(m){s[16](m)}let fe={id:"query",label:"Filter by ID",placeholder:"E.g. arcadia",showErrors:!1,minlength:0};s[0]!==void 0&&(fe.value=s[0]),g=new de({props:fe}),$e.push(()=>_e(g,"value",Ae));function De(m){s[17](m)}let ce={id:"target-filter",label:"Filter by systemd target",placeholder:"E.g. arcadia",showErrors:!1,minlength:0};s[1]!==void 0&&(ce.value=s[1]),H=new de({props:ce}),$e.push(()=>_e(H,"value",De));let L={ctx:s,current:null,token:null,hasCatch:!0,pending:Ue,then:Qe,catch:Je,value:18,error:22,blocks:[,,,]};return Be(s[5](),L),{c(){t=A(),e=K("section"),n=K("h2"),r=B("Actions"),o=A(),O(l.$$.fragment),u=A(),O(i.$$.fragment),T=A(),O(a.$$.fragment),p=A(),E.c(),j=A(),b&&b.c(),J=A(),V=K("div"),X=A(),q=K("h2"),Z=B("Services"),x=A(),k&&k.c(),f=A(),O(g.$$.fragment),N=A(),O(H.$$.fragment),U=A(),L.block.c(),this.h()},l(m){Ce("svelte-pkdbb0",document.head).forEach(_),t=D(m),e=R(m,"SECTION",{});var c=F(e);n=R(c,"H2",{class:!0});var te=F(n);r=C(te,"Actions"),te.forEach(_),o=D(c),y(l.$$.fragment,c),u=D(c),y(i.$$.fragment,c),T=D(c),y(a.$$.fragment,c),p=D(c),E.l(c),j=D(c),b&&b.l(c),J=D(c),V=R(c,"DIV",{class:!0}),F(V).forEach(_),X=D(c),q=R(c,"H2",{class:!0});var ne=F(q);Z=C(ne,"Services"),ne.forEach(_),x=D(c),k&&k.l(c),f=D(c),y(g.$$.fragment,c),N=D(c),y(H.$$.fragment,c),U=D(c),L.block.l(c),c.forEach(_),this.h()},h(){document.title="Systemd service list",z(n,"class","text-xl font-semibold"),z(V,"class","mb-3"),z(q,"class","text-xl font-semibold")},m(m,h){S(m,t,h),S(m,e,h),v(e,n),v(n,r),v(e,o),M(l,e,null),v(e,u),M(i,e,null),v(e,T),M(a,e,null),v(e,p),Y[w].m(e,null),v(e,j),b&&b.m(e,null),v(e,J),v(e,V),v(e,X),v(e,q),v(q,Z),v(e,x),k&&k.m(e,null),v(e,f),M(g,e,null),v(e,N),M(H,e,null),v(e,U),L.block.m(e,L.anchor=null),L.mount=()=>e,L.anchor=null,W=!0},p(m,[h]){s=m;const c={};h&8388608&&(c.$$scope={dirty:h,ctx:s}),l.$set(c);const te={};h&8388608&&(te.$$scope={dirty:h,ctx:s}),i.$set(te);const ne={};h&8388608&&(ne.$$scope={dirty:h,ctx:s}),a.$set(ne);let oe=w;w=ie(s),w===oe?Y[w].p(s,h):(se(),d(Y[oe],1,1,()=>{Y[oe]=null}),re(),E=Y[w],E?E.p(s,h):(E=Y[w]=ee[w](s),E.c()),$(E,1),E.m(e,j)),s[4]?b?(b.p(s,h),h&16&&$(b,1)):(b=we(s),b.c(),$(b,1),b.m(e,J)):b&&(se(),d(b,1,1,()=>{b=null}),re()),s[2]!=""?k?(k.p(s,h),h&4&&$(k,1)):(k=ve(s),k.c(),$(k,1),k.m(e,f)):k&&(se(),d(k,1,1,()=>{k=null}),re());const ue={};!I&&h&1&&(I=!0,ue.value=s[0],pe(()=>I=!1)),g.$set(ue);const me={};!Q&&h&2&&(Q=!0,me.value=s[1],pe(()=>Q=!1)),H.$set(me),He(L,s,h)},i(m){W||($(l.$$.fragment,m),$(i.$$.fragment,m),$(a.$$.fragment,m),$(E),$(b),$(k),$(g.$$.fragment,m),$(H.$$.fragment,m),$(L.block),W=!0)},o(m){d(l.$$.fragment,m),d(i.$$.fragment,m),d(a.$$.fragment,m),d(E),d(b),d(k),d(g.$$.fragment,m),d(H.$$.fragment,m);for(let h=0;h<3;h+=1){const c=L.blocks[h];d(c)}W=!1},d(m){m&&_(t),m&&_(e),P(l),P(i),P(a),Y[w].d(),b&&b.d(),k&&k.d(),P(g),P(H),L.block.d(),L.token=null,L=null}}}function Ze(s,t,e){const n=async()=>{let f=await fetch("/api/systemd/getServiceList",{method:"POST"});if(!f.ok){let g=await f.text();throw new Error(g)}return await f.json()};let r="",o="";const l=(f,g,I)=>{var H,Q,U,W,ee;let N=!0;if(g!=""&&!((H=f==null?void 0:f.ID)!=null&&H.toLowerCase().includes(g.toLowerCase()))&&(N=!1),I!="")if(I.startsWith("!")){let Y=I.substring(1);((U=(Q=f==null?void 0:f.Service)==null?void 0:Q.Target)==null?void 0:U.toLowerCase())==Y&&(N=!1)}else((ee=(W=f==null?void 0:f.Service)==null?void 0:W.Target)==null?void 0:ee.toLowerCase())!=I.toLowerCase()&&(N=!1);return N};let u="",i=[];const T=async()=>{let f=await fetch("/api/systemd/buildServices",{method:"POST"});if(!f.ok){let g=await f.text();ae(g);return}e(2,u=await f.text()),Ne(u,g=>{e(3,i=g)})},a=async()=>{if(window.prompt("Are you sure you want to restart the server? (YES to confirm))")!="YES")return;let g=await fetch("/api/systemd/restartServer",{method:"POST"});if(!g.ok){let I=await g.text();ae(I);return}ge("Server is now restarting...")},p=async f=>{if(window.prompt(`Are you sure you want to ${f} all services? (YES to confirm)`)!="YES")return;let I=await fetch(`/api/systemd/serviceMod?act=${f}`,{method:"POST"});if(!I.ok){let N=await I.text();ae(N);return}ge(`All services are now ${f}...`)};let w=!1;const E=()=>T(),j=()=>e(4,w=!1),J=()=>e(4,w=!0),V=()=>a(),X=()=>p("killall"),q=()=>p("startall");function Z(f){r=f,e(0,r)}function x(f){o=f,e(1,o)}return[r,o,u,i,w,n,l,T,a,p,E,j,J,V,X,q,Z,x]}class ot extends Te{constructor(t){super(),Ie(this,t,Ze,Xe,Le,{})}}export{ot as component};
